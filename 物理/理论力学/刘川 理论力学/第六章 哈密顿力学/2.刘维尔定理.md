## $\S2$ 刘维尔定理

### 一、广义坐标与广义动量的统一

在哈密顿正则体系中广义坐标与广义动量关系更为平等，因此可将二者置于同一变量下：
$$
\begin{align}
\xi^j &= q^j , j=1,...,n\\
\xi^j &= p_{j-n} , j = n+1,...,2n
\end{align}
$$
则哈密顿方程可改写为：
$$
\dot\xi^j=\omega^{jk}\part_k H
$$
其中($j$为行指标  $k$为列指标)
$$
\begin{align}
\omega=
\left(
\begin{aligned}
&\mathbb 0_{n\times n}&\mathbb 1_{n\times n}\\
&-\mathbb 1_{n\times n}&\mathbb 0_{n\times n}
\end{aligned}
\right)
\end{align}
$$


### 二、刘维尔定理推导

考虑$t=0$时刻相空间的一个小体积元$d^{2n}\xi(0)$，当该体积元按照哈密顿正则方程演化，经过时间$t$后变为体积元$d^{2n}\xi(t)$，它们之间相差一个雅可比矩阵
$$
\begin{align}
J(\xi(t);\xi(0))
&=
det
\left(
\frac{\part \xi(t)}{\part \xi(0)}
\right)\\
&=
det\left(\frac{\part(\xi^1(t)),...\xi^{2n}(t)}{\part(\xi^1(0)),...\xi^{2n}(0)}\right)
\end{align}
$$
现在我们定义矩阵$M(t)$，其矩阵元为
$$
M_{ij}=\frac{\part \xi_t^i}{\part \xi_0^j}
$$
显然，$J(t)=det\ M(t)$，由公式$ln\ det\ M=Tr\ ln\ M$，有

$$
\begin{align}
\frac{dJ(t)}{dt}
&=\frac{d}{dt}e^{ln\ det\ M}\\
&=\frac{d}{dt}e^{Tr\ ln\ M}\\
&=J(t)Tr(M^{-1}\dot M)\\
\end{align}
$$
又：

$$
M^{-1}_{ij}=\frac{\part \xi_0^j}{\part \xi_t^i}
$$

>proof.
>
>$i,j$相等时：
>
>```math
>(MM^{-1})_{ii}=\sum_j\frac{\part \xi_t^i}{\part \xi_0^j}\cdot\frac{\part \xi_0^j}{\part \xi_t^i}=1
>```
>
>$i,j$不等时：
>
>```math
>\begin{align}
>(MM^{-1})_{ij}
>&=\sum_kM_{ik}M^{-1}_{kj}\\
>&=\sum_k\frac{\part \xi_t^i}{\part \xi_0^k}\cdot\frac{\part \xi_0^k}{\part \xi_t^j}\\
>&=\frac{\part \xi_t^i}{\part \xi_t^j}\\
>&=0
>\end{align}
>```
>

因此:

```math
Tr(M^{-1}\dot M)=\sum_j\frac{\part \xi_0^i}{\part \xi_t^j}\frac{\part \dot\xi_t^j}{\part \xi_0^i}
```

进而得到(重复指标隐含求和)：

```math
Tr(M^{-1}\dot M)=\frac{\part \xi_0^i}{\part \xi_t^j}\frac{\part \dot\xi_t^j}{\part \xi_t^k}\frac{\part \xi_t^k}{\part \xi_0^i}=\delta_{jk}\frac{\dot \part \xi_t^j}{\part \xi_t^k}=\frac{\dot \part \xi_t^j}{\part \xi_t^j}
```

由此可得$J(t)$关于时间的演化规律：

```math
\frac{dJ}{dt}=J\part_j\dot\xi^j
```

由于$\omega^{jk}$的反对陈性，显然有$\part_j\dot\xi^j=0$，这意味着相空间的体积元不随时间改变，该定理称为**刘维尔(Liouville)定理**

依据刘维尔定理的推导过程，可知该定理对于所有哈密顿系统均成立，而对于非哈密顿系统，可以有$\part_j\dot\xi^j\equiv\kappa(\xi)\not=0$(在经典力学体系下，物体的运动完全由其坐标及其一阶导数决定).对上述方程积分，得到：

```math
\begin{align}
J=exp\left[\int_0^tds\ \kappa\left(\xi(s)\right)\right]
\end{align}
```

由此，引入权函数$W(\xi(t))=\int_0^tds\ \kappa(\xi(s))$，并令$\sqrt{g(t)}\equiv e^{-W(\xi(t))}$，则有：

```math
\sqrt{g(t)}d^{2n}\xi(t)=\sqrt{g(0)}d^{2n}\xi(0)
```

该结论称为推广的刘维尔定理