##$\Gamma$函数

### 常用定义

```math
\Gamma\left(z\right)=\int_{0}^{\infty}\mathrm{e}^{-t}t^{z-1}\mathrm{d}t\quad\mathrm{Re}z>0
```

其中的积分变量$t$应该理解为$\arg t = 0$

称为第二类 Euler 积分

上述积分定义可以修改为

```math
\Gamma\left(z\right)=\int_{L}\mathrm{e}^{-t}t^{z-1}\mathrm{d}t\quad\mathrm{Re}z>0
```

其中积分路径$L$是$t$平面上从$t=0$除法的半射线$\arg t =\alpha$为常熟，$\abs{\alpha}<\pi/2$

此外，可进一步将积分路径的修改为修改为从$t=0$出发的任意分段光滑曲线，只要最后$\Re t\to 0$

> 可通过构建围道证明上述式子相等

### 基本性质

+ ```math
  \Gamma(1) = 1
  ```

+ ```math
  \Gamma(z+1) = z\Gamma(z)
  ```

  > 通过简单的代入和分部积分即可证明

  + 推论：

    ```math
    \Gamma(n + 1) = n!,n\in\N
    ```

    因此，$\Gamma$函数又被称为阶乘函数

### 解析性

为讨论$\Gamma$函数的解析性，我们将积分拆成两部分

```math
\begin{aligned}
\Gamma\left(z\right)
&=\int_0^\infty\mathrm{e}^{-t}t^{z-1}\mathrm{d}t\\
&=\underbrace{\int_0^1\mathrm{e}^{-t}t^{z-1}\mathrm{d}t}_{\gamma(z,1)}+\underbrace{\int_1^\infty\mathrm{e}^{-t}t^{z-1}\mathrm{d}t}_{\Gamma(z,1)}\end{aligned}
```

先看第二部分

> 由于
>
> + 被积函数是$t$的连续函数
> + 其作为$z$的函数，在全平面解析
>
> 因此只需要证明积分的一致收敛即可证明解析性
>
> 对于 $1\to \infin $积分的处理，根据$e^t = 1 + t + \frac{t}{2}+...+\frac{t^n}{n!}+...$可以得到
>
> ```math
> e^t \geq \frac{t^n}{n!}
> ```
>
> 由此可将积分限定范围
>
> ```math
> \begin{align}
> \int_1^\infty\mathrm{e}^{-t}t^{z-1}\mathrm{d}t
> &=\int_{1}^{\infin}e^{-t} t ^{x-1} t^{iy}dt\\
> &\le \int_{1}^{\infin}e^{-t}t^{x-1}dt\\
> &\le \int_{1}^{\infin}n!t ^{x-n-1}dt\\
> &\le \int_{1}^{\infin}n!t ^{x_0-n-1}dt
> \end{align}
> ```
>
> 对于任意闭区域，必然存在$x$坐标最大的点，记其$x$坐标为$x_0$，对此$x_0$必然存在常值$n$使得上述积分收敛，由此得到上述积分在全平面内闭一致连续（严格来说上面那个1应该改成一个可以任意大的数（））
>
> 由此可以得出第二部分在全平面解析

对于第一部分

> 显然可以得到当$x\le 0$时不收敛，
>
> 与上面类似，取$x$坐标最小的点的$x$坐标为$\delta> 0 $
>
> 则
>
> ```math
> \int_{0}^{1}e^{-t}t^{z-1}dt \le \int_{0}^{1}t^{\delta - 1}dt
> ```
>
> 由此可以证明，当$\delta > 0$时，上述积分在右半平面內闭一致连续，由此得到在右半平面函数解析
>
> （这里同理，1应该改成一个可以任意接近0的数）

最终得到$\Gamma$在右半平面解析

### 解析延拓

由于定义

```math
\Gamma(z)=\int_0^\infty\mathrm{e}^{-t}t^{z-1}\mathrm{d}t=\int_0^1\mathrm{e}^{-t}t^{z-1}\mathrm{d}t+\int_1^\infty\mathrm{e}^{-t}t^{z-1}\mathrm{d}t
```

中第一部分只在右半平面解析，因此需要想办法将第一部分延拓到全平面

####方法一

其中一种方法为将指数函数作Taylor展开

```math
\begin{aligned}\int_0^1\mathrm{e}^{-t}t^{z-1}\mathrm{d}t&=\sum_{n=0}^\infty\frac{(-)^n}{n!}\int_0^1t^{n+z-1}\mathrm{d}t\\&=\sum_{n=0}^\infty\frac{(-)^n}{n!}\frac{1}{n+z}\end{aligned}
```

该结果是在$\Re z > 0 $时得到，但右边级数在全平面一致收敛，因而在全平面解析（$z\not = 0,-1,...$）

（🤔好神奇,那个积分和求和换序的操作显然是基于右半平面一致收敛的结果，但交换后的式子却能够在整个平面一致收敛）

因此，$\Gamma(z)$的下列表达式在全平面有效

```math
\Gamma\left(z\right)=\int_{1}^{\infty}\mathrm{e}^{-t}t^{z-1}\mathrm{d}t+\sum_{n=0}^{\infty}\frac{(-)^{n}}{n!}\frac{1}{n+z}(z\neq0,-1,-2,\cdots)
```

> 🤔老头子自己也说这个表达式不常用

#### 方法二

根据递推关系$\Gamma(z+1) = z \Gamma(z)$作延拓

首先将递推关系改为

```math
\Gamma\left(z\right)=\frac{1}{z}\Gamma\left(z+1\right)
```

+ 左端在$\Re z>0$解析
+ 右端在$\Re z>1$，且$z\not = -1$解析
+ 二者在共同解析的部分相等

由此可以将上述表达式看作$\Re z > -1$部分的延拓，由此递推可以得到全平面的延拓

其中$z=0,-1,-2,...$均为一阶极点

（有一说一，这玩意真有比上面那个好到哪里去吗🤔）

### 性质2

+ ==互余宗量定理==

  ```math
  \Gamma\left(z\right)\Gamma\left(1-z\right)=\frac{\pi}{\sin\pi z}
  ```

  > proof.
  >
  > ```math
  > \begin{align}
  > \Gamma\left(z\right)\Gamma\left(1-z\right)
  > &=\Beta(z,1-z)\\
  > &=\int_{0}^{1}t^{z-1}(1-t)^{-z}\mathrm{d}t\\
  > &=\int_{0}^{1}\left(\frac{t}{1-t}\right)^{z}/t\mathrm{d}t
  > \end{align}
  > ```
  >
  > 令🤔
  >
  > ```math
  > x=\frac{t}{1-t}
  > ```
  >
  > 则，原式可化为
  >
  > ```math
  > \int_{0}^{\infin}\frac{x^{z-1}}{1+x}\mathrm{d}x
  > ```
  >
  > 利用留数定理计算多值函数积分可以得到结果
  >
  > > ps，
  > >
  > > 以上证明建立在
  > >
  > > ```math
  > > \Re z>0\ \ \Re(1-z)>0
  > > ```
  > >
  > > 的基础上证明，但由于等式两端在全平面解析，由解析延拓原理可知式子在全平面成立
  
  > 推论
  >
  > + ```math
  >   \Gamma(1/2)=\sqrt{\pi}
  >   ```
  >
  > + $\Gamma$函数在全平面无零点
  >
  >   > proof.
  >   >
  >   > + 因为$\mathrm{}\pi/\operatorname{sin}\pi z\neq0$所以$\Gamma(z)\Gamma(1-z)\not = 0$
  >   > + 因此，假设存在零点$z_0$
  >   > + 此时，
  
+ ==倍乘公式==

  ```math
  \Gamma(2z)=2^{2z-1}\pi^{-1/2}\Gamma(z)\Gamma(z+1/2)
  ```

  该式子也可以延拓到整个平面

  > proof.
  >
  > 

  > 当$z=2n$时，有
  >
  > ```math
  > \Gamma\left(2n\right)=2^{2n-1}\pi^{-1/2}\Gamma\left(n\right)\Gamma\left(n+1/2\right)
  > ```
  >
  > 即
  >
  > ```math
  > \begin{aligned}(2n-1)!&=2^{2n-1}(n-1)!(n-1/2)\\&\times(n-3/2)\cdots(3/2)(1/2)\end{aligned}
  > ```
  >
  > 🤔这个$\pi^{-1/2}$好像来自于$\Gamma(1/2)$很神奇（😭这个$\Gamma(1/2)$到底怎么算啊）

  此外，可以按照上面这个实数的特殊解猜测

  ```math
  \Gamma(3z)=\frac{3^{3z-1}\Gamma(z)\Gamma(z+1/3)\Gamma(z+2/3)}{\Gamma(1/3)\Gamma(2/3)}
  ```

  

  > proof.
  >
  > 首先计算积分
  >
  > ```math
  > I=\int_{-1}^{1}(1-x^{2})^{z-1}\mathrm{d}x
  > ```
  >
  > + 令$t=(1-x^2)$，则
  >
  >   ```math
  >   \begin{align}
  >   I
  >   &=2\int_{0}^{1} t^{z-1} \frac{-1/2}{\sqrt{1-t}}dt\\
  >   &=-\int_{0}^{1}t^{z-1}(1-t)^{-1/2}dt\\
  >   &=-\Beta(z,1/2)\\
  >   &=\frac{\Gamma(z)\Gamma(1/2)}{\Gamma(z+1/2)}
  >   \end{align}
  >   ```
  >
  > + 令$1+x=2t$，则$1-x=2(1-t)$，此时有
  >
  >   ```math
  >   \begin{align}
  >   I
  >   &=2^{2z-1}\int_{0}^{1}t^{z-1}(1-t)^{z-1}dt\\
  >   &=2^{2z-1}\Beta(z,z)\\
  >   &=2^{2z-1}\frac{\Gamma(z)\Gamma(z)}{\Gamma(2z)}
  >   \end{align}
  >   ```
  >
  > 考虑到$\Gamma(z)$无零点，可直接消去，进而得到
  >
  > ```math
  > \Gamma(2z)=2^{2z-1}\frac{\Gamma(z)\Gamma(z+1/2)}{\Gamma(1/2)}
  > ```
  >
  > 进而得证
  >
  > > ps，证明过程中对$\Beta$的使用时隐含了$\Re z>0$，但同样的，利用解析延拓，可以将证明拓展到全平面

+ $\Gamma$函数的==渐近展开==（Stirling公式）

  > PS.
  >
  > 渐近展开与Taylor展开和Laurent展开不同，不是项数越多准确性越高，而是$\abs{z}$越接近一定值越准确，项数多反而可能造成误差增大🤔（不要求级数收敛的结果🤔）

  当$\abs{z}\to \infin，\abs{\arg z}< \pi$时，有

  ```math
  \begin{aligned}\Gamma\left(z\right)&\sim z^{z-1/2}\mathrm{e}^{-z}\sqrt{2\pi}\Bigg(1+\frac{1}{12z}\\&+\frac{1}{288z^{2}}-\frac{139}{51840z^{3}}-\frac{571}{2488320z^{4}}+\cdots\Bigg)\end{aligned}
  ```

  > 🤔在数分里我记得好像证明过弱化版本
  >
  > ```math
  > n! \sim \left(\frac{n}{e}\right)^{n}\sqrt{2\pi n}
  > ```

  物理中常用

  ```math
  \ln n! \sim n \ln n - n
  ```

### $\psi$函数、$\Beta$函数

#### $\psi$函数

```math
\psi(z)=\frac{\Gamma^{\prime}(z)}{\Gamma\left(z\right)}=\frac{\mathrm{d}\ln\Gamma\left(z\right)}{\mathrm{d}z}
```

而对$\psi$函数的延拓与$\Gamma$函数的递推延拓方法一致

```math
\psi(z+1)=\frac{1}{z}+ \psi(z)
```

由此得到

+ ```math
  \begin{aligned}\psi(z+n+1)&=\psi(z)+\left(\frac{1}{z+n}+\frac{1}{z+n-1}+\cdots+\frac{1}{z}\right)\end{aligned}
  ```

  某些时候可以用来表示一堆数求和🤔

+ 进而可得

  $z=-n,n=0,1,2,...$是$\psi(z)$的一阶极点，$\Res\psi(-n) = -1$

  (ps.这个可以通过上面那个玩意证明留数)

+ ```math
  \psi(z)-\psi(1-z)=-\pi \cot \pi z
  ```

  这玩意可以由互余宗量定理推出

  > 注意
  >
  > ```math
  > \frac{d\ln\Gamma(1-z)}{dz} = -\psi(1-z)
  > ```

+ ```math
  \psi(1-z)=\psi(z)+\pi\cot \pi z
  ```

#### $\Beta$函数

```math
\mathrm{B}(p,q)=\int_{0}^{1}t^{p-1}(1-t)^{q-1}\mathrm{d}t\quad\mathrm{Re}p>0\mathrm{Re}q>0
```

其中的积分变量$t$应该理解为$\arg t = 0$

这个积分称为第一类Euler积分

做变换$t=\sin^2\theta$，可得到$\Beta$函数的另一个表达式

```math
\mathrm{B}(p,q)=2\int_0^{\pi/2}\sin^{2p-1}\theta\cos^{2q-1}\theta\mathrm{d}\theta
```

+ $\Beta(p,q) = \Beta(q,p)$

  > proof.做变换$t=1-s$，容易证明

+ $\Beta$函数可以用$\Gamma$函数表示

  ```math
  \mathrm{B}(p,q)=\frac{\Gamma\left(p\right)\Gamma\left(q\right)}{\Gamma\left(p+q\right)}
  ```

  > proof.
  >
  > 令$t=x^2$，则
  >
  > ```math
  > \begin{align}
  > \Gamma(p) 
  > &= \int_{0}^{\infin}e^{-t}t^{p-1}\mathrm{d}t\\
  > &= \int_{0}^{\infin}e^{-x^2}x^{2p-1}\mathrm{d}x
  > \end{align}
  > ```
  >
  > 同理
  >
  > ```math
  > \Gamma(q) = \int_{0}^{\infin}e^{-y^2}y^{2q-1}\mathrm{d}y
  > ```
  >
  > 由此可得
  >
  > ```math
  > \begin{align}
  > \Gamma(p)\Gamma(q)
  > &=4\int_0^\infty\int_0^\infty\mathrm{e}^{-(x^2+y^2)}x^{2p-1}y^{2q-1}\mathrm{d}x\mathrm{d}y\\
  > &=4\int_{0}^{\infty}\int_{0}^{\pi/2}\mathrm{e}^{-r^{2}}(r\cos\theta)^{2p-1}(r\sin\theta)^{2q-1}r\mathrm{d}r\mathrm{d}\theta\\
  > &=4\int_{0}^{\infty}\mathrm{e}^{-r^{2}}r^{2p+2q-2}r\mathrm{d}r\int_{0}^{\pi/2}\mathrm{cos}^{2p-1}\theta\mathrm{sin}^{2q-1}\theta\mathrm{d}\theta\\
  > &=\Gamma(p+q)\mathrm{B}(p,q)
  > \end{align}
  > ```

  通过该等式，可以实现将$\Beta$函数延拓至全平面

  
