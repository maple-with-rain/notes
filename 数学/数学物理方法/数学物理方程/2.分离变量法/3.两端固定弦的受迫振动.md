##定解问题

$$
\begin{aligned}&\frac{\partial^2u}{\partial t^2}-a^2\frac{\partial^2u}{\partial x^2}=f(x,t)&&0<x<l,t>0\\
&u|_{x=0}=0\quad u|_{x=l}=0&&t\geqslant0\\
&u|_{t=0}=0\quad\frac{\partial u}{\partial t}|_{t=0}=0\quad&&0\leqslant x\leqslant l\end{aligned}
$$



##方法一：方程和边界条件同时齐次化

令$u(x,t)=v(x,t)+w(x,t)$，使得
$$
\boxed{\frac{\partial^2u}{\partial t^2}-a^2\frac{\partial^2u}{\partial x^2}=f(x,t)}\Longrightarrow
\begin{aligned}
&\boxed{\frac{\partial^2v}{\partial t^2}-a^2\frac{\partial^2v}{\partial x^2}=f(x,t)}\\
&\boxed{\frac{\partial^2w}{\partial t^2}-a^2\frac{\partial^2w}{\partial x^2}=0}
\end{aligned}
$$
进而将原定解问题等价于
$$
\boxed{\begin{array}{l}\frac{\partial^2v}{\partial t^2}-a^2\frac{\partial^2v}{\partial x^2}=f(x,t)\\v|_{x=0}=0\quad v|_{x=l}=0\\\text{初始条件(不作要求)}\end{array}}+\boxed{\begin{array}{l}\frac{\partial^2w}{\partial t^2}-a^2\frac{\partial^2w}{\partial x^2}=0\\w|_{x=0}=0\quad w|_{x=l}=0\\\text{初始条件}\end{array}}
$$

+ 其中，二者均不要求初始条件
+ 加号左边由于少了初始条件，无法得出唯一解，但得出==一个特解==可能较为简单

+ 而加号右边则可以解出一系列特征解，之后，再考虑初始条件
  $$
  \begin{aligned}&w|_{t=0}=-v|_{t=0}\\
  &\left.\frac{\partial w}{\partial t}\right|_{t=0}=-\left.\frac{\partial v}{\partial t}\right|_{t=0}\end{aligned}
  $$
  确定特征解的叠加系数就可以

> 基本思路是将非齐次项的考虑分解，对于$v$方程的解只需要考虑一个非齐次项，而初始条件和$v$导致的变化中的非齐次项由$w$进行线性叠加符合

###$f(x,t)=g(x)$

尝试将齐次函数化为
$$
u(x,t)=v(x)+w(x,t)
$$
进而就能得到一个常微分方程与偏微分方程，求解即可

### $ f(x,t)=A_0\sin\omega t$

考虑边界条件，此处无法分离成$u(x,t)=v(t)+w(x,t)$

考虑$(\sin\omega t)''=-w^2(\sin\omega t)$以及方程中仅含时间的二阶导，

可以尝试取定$v(x,t)=f(x)\sin\omega t$，以便于化简，得到
$$
-\omega^{2}f(x)-a^{2}f^{\prime\prime}(x)=A_{0}
$$
进而变为根据条件求解常微分方程，得到一个特解
$$
\begin{aligned}f(x)&=-\frac{A_{0}}{\omega^{2}}\left[\left(1-\cos\frac{\omega}{a}x\right)-\tan\frac{\omega l}{2a}\sin\frac{\omega}{a}x\right]\\&=-\frac{A_0}{\omega^2}\left[1-\frac{\cos\frac{\omega}{a}\left(x-\frac{l}{2}\right)}{\cos\frac{\omega l}{2a}}\right]\end{aligned}
$$

> 我自己的想法是求解下面方程
> $$
> \begin{aligned}
> &f(x,t)=A_0e^{i\omega t}\\
> &f(x,t)=A_0e^{-i\omega t}
> \end{aligned}
> $$
> 之后根据叠加性原理得到原方程的一个特解，之后通过函数的取定得到特解，但实际求解之后发现好像不太对劲，这里得出的特解是
> $$
> u(x,t)=-\frac{A_0}{\omega^2}\sin\omega t
> $$
> 然后我们需要通过
> $$
> \left\{
> \begin{aligned}
> \phi(x+at)\\
> \psi(x-at)
> \end{aligned}
> \right.
> $$
> 凑出一个满足边界条件的解？？？（反正我看不出来怎么凑，毁灭吧😒）
>
> > 懒得管了，忙着速通去理力呢😭

> 🤔这玩意显然适用于$\cos\omega t$，所以是不是也可以Laplace展开❓



## Poisson方程的解

## 例：求解定解问题

$$
\begin{aligned}&\begin{aligned}\frac{\partial^2u}{\partial x^2}+\frac{\partial^2u}{\partial y^2}=xy\end{aligned}&&0<x<a,0<y<b\\&u|_{x=0}=0\quad u|_{x=a}=0&&0\leqslant y\leqslant b\\&u|_{y=0}=\phi(x)\quad u|_{y=b}=\psi(x)&&0\leqslant x\leqslant a\end{aligned}
$$

 

同样的，考虑
$$
u(x,t)=v(x,t)+w(x,t)
$$
分为两个仅考虑$x$的边界条件的偏微分方程，之后叠加，以满足关于$y$边界的条件

其中,对于方程
$$
\begin{aligned}
&\frac{\partial^2v}{\partial x^2}+\frac{\partial^2v}{\partial y^2}=xy\\
&v|_{x=0}=0\quad v|_{x=a}=0
\end{aligned}
$$
考虑到齐次条件，容易看出方程的特解为
$$
\frac{1}{6}x^3y,\frac{1}{6}xy^3,\frac{1}{12}(x^3y+xy^3),\cdots
$$
相应齐次方程的特解为
$$
1,x,y,xy,\cdot\cdot\cdot
$$

> 实际上，这堆玩意的相似性明显就来自于二维这个条件，怎么可能不一样😂



##方法二：按照相应齐次问题本征函数展开

> #### 分离变量法
>
> + 所谓分离变量法，只是提供了一种求特解的方法：再求解过程中得到的特解是分离变量形式的
>
> + 一旦叠加后，得到的一般解就不再是分离变量的
> + 可以从另一个角度审视分离变量法：间接说明了==本征函数组的完备性==
> + 分离变量法提供了一种求完备函数组的方法

如果非齐次项$f(x,t)$的形式比较复杂，难以求得非齐次方程的特解，就可以采用下面解法

### 中心思想

中心思想是设法找到一组本征函数$\{X_n(x),n=1,2,\cdot\cdot\cdot\}$，只要这组本征函数是完备的，就可以将解$u(x,t)$及非齐次方程的非齐次项$f(x,t)$均按本征函数展开
$$
\begin{gathered}u(x,t)=\sum_{n=1}^\infty T_n(t)X_n(x)\\f(x,t)=\sum_{n=1}^\infty g_n(t)X_n(x)\end{gathered}
$$
然后再设法求出$T_n(x)$即可

> PS，以一维弦为例，这里是将弦的振动分为多个独立的，弦上每一点振动相位一致，仅有振幅差别的振动，而对$f(x,t)$的分解也自然如此
>
> > 此外，还有一个基础：随着$t$的改变，$u(x,t)$必须改变较为缓慢，以保证每一个$T_n(t)$的连续性🤔（你别问我为什么这样就行了，我也是猜的）（）
>
> > 但是这玩意也是建立在这种振动本身属于一种可分离的状态，会不会有不可分离的情况呢❓
>
> > 这也是为什么我们需要保证本征函数的完备性🤔



### 解题步骤

1. 求出相应其次问题的本征函数$X_n(x)$

2. 将$u(x,t)$及$f(x,t)$按$\{X_n(x)\}$展开

3. 将$u(x,t)$及$f(x,t)$代入偏微分方程，根据本征函数的正交性，导出$T_n(t)$满足的常微分方程

   > 那么，我们现在的问题就是如何确定$T_n(t)$和$g_n(t)$

4. 将$u(x,t)$代入初始条件，根据本征函数的正交性，导出$T_n(t)$满足的初始条件

5. 求出$T_n(t)$



### 本征函数的选取

最简单的方法显然是根据
$$
\begin{aligned}&\frac{\partial^2u}{\partial t^2}-a^2\frac{\partial^2u}{\partial x^2}=0&&0<x<l,t>0\\&u|_{x=0}=0\quad u|_{x=l}=0&&t\geqslant0\end{aligned}
$$
分离变量得到的本征问题
$$
\begin{aligned}&X_{n}^{\prime\prime}(x)+\lambda_{n}X_{n}(x)=0\\&X_{n}(0)=0\quad X_{n}(l)=0\end{aligned}
$$
求得
$$
\begin{aligned}&\text{本征值}&&\lambda_{n}=\left(\frac{n\pi}{l}\right)^{2}\quad n=1,2,3,\cdots\\&\text{本征函数}&&X_{n}(x)=\sin\frac{n\pi}{l}x\end{aligned}
$$


### 将$u(x,t)$及$f(x,t)$按相应齐次问题本征函数展开

$$
u(x,t)=\sum_{n=1}^{\infty}T_{n}(t)X_{n}(x)\quad f(x,t)=\sum_{n=1}^{\infty}g_{n}(t)X_{n}(x)
$$

这里利用$\{X_n(x)\}$的正交性就可以很好的求出$g_n(t)$



### 导出$T_n(t)$满足的常微分方程

$$
\sum_{n=1}^{\infty}T_{n}^{\prime\prime}(t)X_{n}(x)-a^{2}\sum_{n=1}^{\infty}T_{n}(t)X_{n}^{\prime\prime}(x)=\sum_{n=1}^{\infty}g_{n}(t)X_{n}(x)
$$

根据
$$
X_{n}^{\prime\prime}(x)+\lambda_{n}X_{n}(x)=0
$$
可以得出
$$
\sum_{n=1}^{\infty}T_{n}^{\prime\prime}(t)X_{n}(x)+a^{2}\sum_{n=1}^{\infty}\lambda_{n}T_{n}(t)X_{n}(x)=\sum_{n=1}^{\infty}g_{n}(t)X_{n}(x)
$$
考虑本征函数的正交性，展开具有唯一性，可以比较系数
$$
T_{n}^{\prime\prime}(t)+\lambda_{n}a^{2}T_{n}(t)=g_{n}(t)
$$
此外，考虑初始条件，可以得到
$$
\begin{aligned}&\boxed{\sum_{n=1}^\infty T_n(0)X_n(x)=0}\Longrightarrow\boxed{T_n(0)=0}\\
&\boxed{\sum_{n=1}^\infty T_n^{\prime}(0)X_n(x)=0}\Longrightarrow\boxed{T_n^{\prime}(0)=0}\end{aligned}
$$
现在，求解初值问题
$$
\begin{aligned}&T_{n}^{\prime\prime}(t)+\lambda_{n}a^{2}T_{n}(t)=g_{n}(t)\\&T_{n}(0)=0\quad T_{n}^{\prime}(0)=0\end{aligned}
$$

> + 求常微分方程特解，和齐次方程通解，根据边界条件确定具体解
> + 利用常数变易法，求出通解，后将通解中的系数变为依赖于$t$的函数
> + 利用Laplace变换
>
> 😭😭😭不会解常微分方程啊，又要返工😭😭😭
>
> 😭😭😭我大一学了什么啊😭😭😭

求得
$$
T_n(t)=\frac{l}{n\pi a}\int_0^tg_n(\tau)\sin\frac{n\pi}{l}a(t-\tau)\mathrm{d}\tau
$$

> 我们强调为相应齐次问题的本征函数是为了确保得到的常微分初值问题为常微分方程，而非常微分方程组🤔